#!/bin/bash

# Output CSV file
output_file="pokemon_report.csv"

# Initialize CSV header
echo "Name,Height (m),Weight (kg)" > "$output_file"

# Process all JSON files
for file in pokemon_data/*.json; do
    # Extract and format data using jq and sed
    jq -r '"\(.name),\(.height/10),\(.weight/10)"' "$file" | \
    sed 's/^\(.\)/\U\1/' >> "$output_file"
done

# Calculate averages using awk
awk -F, '
NR > 1 {  # Skip header
    total_h += $2
    total_w += $3
    count++
}
END {
    printf "\nAverage Height: %.2f m\n", total_h/count
    printf "Average Weight: %.2f kg\n", total_w/count
}
' "$output_file"

# Display report
echo "CSV Report generated at: $output_file"
cat "$output_file"