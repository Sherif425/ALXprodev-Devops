# #!/bin/bash

# # Output CSV file
# output_file="pokemon_report.csv"

# # Header for CSV
# echo "Name,Height (m),Weight (kg)" > "$output_file"

# # Initialize totals for averages
# total_height=0
# total_weight=0
# count=0

# # Process each JSON file in pokemon_data directory
# for file in pokemon_data/*.json; do
#     # Extract data using jq
#     name=$(jq -r '.name' "$file" | awk '{print toupper(substr($0,1,1)) substr($0,2)}')
#     height=$(jq -r '.height/10' "$file")
#     weight=$(jq -r '.weight/10' "$file")
    
#     # Add to CSV
#     echo "$name,$height,$weight" >> "$output_file"
    
#     # Accumulate for averages
#     total_height=$(awk "BEGIN {print $total_height + $height}")
#     total_weight=$(awk "BEGIN {print $total_weight + $weight}")
#     count=$((count + 1))
# done

# # Calculate averages
# avg_height=$(awk "BEGIN {printf \"%.2f\", $total_height/$count}")
# avg_weight=$(awk "BEGIN {printf \"%.2f\", $total_weight/$count}")

# # Display report
# echo "CSV Report generated at: $output_file"
# echo
# cat "$output_file"
# echo
# echo "Average Height: $avg_height m"
# echo "Average Weight: $avg_weight kg"

#!/bin/bash

# Output CSV file
output_file="pokemon_report.csv"

# Initialize CSV header
echo "Name,Height (m),Weight (kg)" > "$output_file"

# Process files and collect data for averages
awk -F, '
BEGIN {
    OFS = ","
    total_h = 0
    total_w = 0
    count = 0
}
FNR == 1 { next } # Skip header in subsequent files
{
    # Extract from JSON using jq (called within awk)
    cmd = sprintf("jq -r \".name, .height/10, .weight/10\" \"%s\"", FILENAME)
    cmd | getline name
    cmd | getline height
    cmd | getline weight
    close(cmd)
    
    # Capitalize first letter
    name = toupper(substr(name,1,1)) substr(name,2)
    
    # Write to CSV
    print name, height, weight >> "'"$output_file"'"
    
    # Accumulate for averages
    total_h += height
    total_w += weight
    count++
}
END {
    # Calculate and print averages
    avg_h = total_h/count
    avg_w = total_w/count
    printf "\nAverage Height: %.2f m\n", avg_h
    printf "Average Weight: %.2f kg\n", avg_w
}
' pokemon_data/*.json

# Display report
echo "CSV Report generated at: $output_file"
cat "$output_file"